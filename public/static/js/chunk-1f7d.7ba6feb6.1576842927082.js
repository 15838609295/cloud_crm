(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-1f7d"],{"4xV1":function(e,s,i){"use strict";var r=i("baPk");i.n(r).a},baPk:function(e,s,i){},cvMh:function(e,s,i){"use strict";i.r(s);var r={data:function(){return{title:"",form:{id:"",name:"",description:"",permissions:[]},rules:{name:[{required:!0,message:"请输入角色名称",trigger:"change"}],description:[{required:!0,message:"请输入角色概述",trigger:"change"}]}}},watch:{},created:function(){var e=this.$route.query;this.title=e.title,e.id&&(this.form={id:e.id,name:e.name,description:e.description,permissions:[]}),this.getData()},methods:{getData:function(){var e=this,s={id:this.form.id};this.$store.dispatch("GetConnect",{url:"role/auth-list",data:s}).then(function(s){for(var i in e.form.permissions=s.data,e.form.permissions)for(var r in e.form.permissions[i].checkAll=!0,e.form.permissions[i].checks=[],e.form.permissions[i].child)1!==e.form.permissions[i].child[r].has_power?(e.form.permissions[i].child[r].has_power=!1,e.form.permissions[i].checkAll=!1):(e.form.permissions[i].child[r].has_power=!0,e.form.permissions[i].checks.push(e.form.permissions[i].child[r].label))}).catch(function(s){e.$message.error(s.msg+",请刷新或联系管理员")})},handleCheckedAllChange:function(e,s){var i=this.form.permissions[s];for(var r in i.checks=[],i.child)i.child[r].has_power=e,e&&i.checks.push(i.child[r].label);this.form.permissions.splice(s,1,i),this.$set(this.form.permissions[s],"child",i.child)},handleCheckedItemChange:function(e,s){var i=this.form.permissions[s];for(var r in i.checks=[],i.child)i.child[r].has_power&&i.checks.push(i.child[r].label);i.checks.length===i.child.length?i.checkAll=!0:i.checkAll=!1,this.form.permissions.splice(s,1,i),this.$set(this.form.permissions[s],"child",i.child)},onSubmit:function(e){var s=this;this.$refs[e].validate(function(e){if(e){var i=[];for(var r in s.form.permissions)for(var t in s.form.permissions[r].child)s.form.permissions[r].child[t].has_power&&i.push(s.form.permissions[r].child[t].id);var o=s.form.id?"/role/edit/"+s.form.id:"/role/create",n={id:s.form.id,name:s.form.name,description:s.form.description,permissions:i.join(",")};s.$store.dispatch("GetConnect",{url:o,data:n}).then(function(e){s.$message.success(e.msg),s.$router.back(-1)}).catch(function(e){s.$message.error("角色操作失败,请刷新或联系管理员!")})}else s.$message.error("提交失败,请检查必填项")})}}},t=(i("4xV1"),i("KHd+")),o=Object(t.a)(r,function(){var e=this,s=e.$createElement,i=e._self._c||s;return i("div",[i("el-card",{staticClass:"box-1"},[i("div",{attrs:{slot:"header"},slot:"header"},[i("span",[e._v(e._s(e.title))])]),e._v(" "),i("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"120px"}},[i("el-form-item",{attrs:{label:"角色名称",prop:"name"}},[i("el-input",{attrs:{autofocus:""},model:{value:e.form.name,callback:function(s){e.$set(e.form,"name",s)},expression:"form.name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"角色概述",prop:"description"}},[i("el-input",{attrs:{type:"textarea",rows:"4"},model:{value:e.form.description,callback:function(s){e.$set(e.form,"description",s)},expression:"form.description"}})],1),e._v(" "),i("el-form-item",{staticClass:"title",attrs:{label:"权限列表"}}),e._v(" "),e._l(e.form.permissions,function(s,r){return i("el-form-item",{key:s.id,attrs:{label:s.label}},[i("el-checkbox",{on:{change:function(s){return e.handleCheckedAllChange(s,r)}},model:{value:s.checkAll,callback:function(i){e.$set(s,"checkAll",i)},expression:"item.checkAll"}},[e._v("全选")]),e._v(" "),i("div",e._l(s.child,function(s){return i("el-checkbox",{key:s.id,attrs:{label:s.label},on:{change:function(s){return e.handleCheckedItemChange(s,r)}},model:{value:s.has_power,callback:function(i){e.$set(s,"has_power",i)},expression:"subitems.has_power"}})}))],1)}),e._v(" "),i("div",{staticClass:"text-center"},[i("el-button",{attrs:{type:"primary"},on:{click:function(s){e.onSubmit("form")}}},[e._v("提 交")])],1)],2)],1)],1)},[],!1,null,"402db621",null);o.options.__file="modifyRole.vue";s.default=o.exports}}]);