(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-4d6b"],{VeBB:function(e,t,o){"use strict";var i=o("nxfw");o.n(i).a},Yfch:function(e,t,o){"use strict";function i(e){return/^(https?|ftp):\/\/([a-zA-Z0-9.-]+(:[a-zA-Z0-9.&%$-]+)*@)*((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])){3}|([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+\.(com|edu|gov|int|mil|net|org|biz|arpa|info|name|pro|aero|coop|museum|[a-zA-Z]{2}))(:[0-9]+)*(\/($|[a-zA-Z0-9.,?'\\+&%$#=~_-]+))*$/.test(e)}function a(e){return/^[A-Za-z0-9\u4e00-\u9fa5]+$/.test(e)&&!/^\d+$/.test(e)}function r(e){return/^[A-Za-z0-9\u4e00-\u9fa5]+$/.test(e)}function l(e,t){for(var o=e.split(""),i=0;i<o.length;i++)i>t-1&&i<o.length-t&&(o[i]="*");return o.join("")}o.d(t,"d",function(){return i}),o.d(t,"c",function(){return a}),o.d(t,"b",function(){return r}),o.d(t,"a",function(){return l})},ehNV:function(e,t,o){"use strict";o.r(t);var i=o("P2sY"),a=o.n(i),r=o("Yfch"),l={data:function(){return{title:"",isDetails:!1,sourceList:[],projectList:[],updateLog:[],activeNames:-1,form:{name:"",realname:"",type:0,mobile:"",spare_mobile:[""],telephone:[""],email:[""],position:"",company:[""],wechat:[""],qq:[""],tencent_id:[""],source:"",project:"",remarks:""},formRules:{name:[{required:!0,message:"请输入客户昵称",trigger:"blur"}],mobile:[{required:!0,message:"请输入手机号码",trigger:"blur"}],type:[{required:!0,message:"请选择客户类型",trigger:"blur"}],source:[{required:!0,message:"请选择客户来源",trigger:"blur"}]}}},watch:{},created:function(){this.title=this.$route.query.title,this.$route.query.id&&("客户详情"===this.title&&(this.isDetails=!0),this.id=this.$route.query.id,this.getCustomerInfo(this.$route.query.id)),this.getSourceList()},methods:{getCustomerInfo:function(e){var t=this,o="customer/detail/"+e;this.$store.dispatch("GetConnect",{url:o}).then(function(e){t.form=e.data,t.isDetails||(t.form.spare_mobile=e.data.spare_mobile?e.data.spare_mobile.split(","):[""],t.form.qq=e.data.qq?e.data.qq.split(","):[""],t.form.wechat=e.data.wechat?e.data.wechat.split(","):[""],t.form.email=e.data.email?e.data.email.split(","):[""],t.form.company=e.data.company?e.data.company.split(","):[""],t.form.telephone=e.data.telephone?e.data.telephone.split(","):[""],t.form.tencent_id=e.data.tencent_id?e.data.tencent_id.split(","):[""]),t.getUpdateLog()}).catch(function(e){t.$message.error(e.msg+",请刷新或联系管理员")})},getSourceList:function(){var e=this;this.$store.dispatch("GetConnect",{url:"member/source-list"}).then(function(t){e.sourceList=t.data}).catch(function(t){e.$message.error(t.msg+",请刷新或联系管理员")})},getUpdateLog:function(){var e=this,t="customer/updateLog/"+this.id;this.$store.dispatch("GetConnect",{url:t}).then(function(t){e.updateLog=t.data.reverse()}).catch(function(t){e.$message.error(t.msg+",请刷新或联系管理员")})},removeItem:function(e,t){var o=this.form[e].indexOf(t);-1!==o&&this.form[e].splice(o,1)},addItem:function(e){this.form[e].push("")},toModify:function(){this.isDetails=!1,this.form.spare_mobile=this.form.spare_mobile?this.form.spare_mobile.split(","):[""],this.form.qq=this.form.qq?this.form.qq.split(","):[""],this.form.wechat=this.form.wechat?this.form.wechat.split(","):[""],this.form.company=this.form.company?this.form.company.split(","):[""],this.form.telephone=this.form.telephone?this.form.telephone.split(","):[""],this.form.tencent_id=this.form.tencent_id?this.form.tencent_id.split(","):[""],this.form.email=this.form.email?this.form.email.split(","):[""],console.log(this.form)},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(e){if(!Object(r.c)(t.form.name))return void t.$message.error("客户名称不能包含特殊字符及纯数字");if(!Object(r.b)(t.form.mobile))return void t.$message.error("客户主要联系方式不能包含特殊字符");var o=a()({},t.form);o.spare_mobile&&(o.spare_mobile=o.spare_mobile.join(",")),o.qq&&(o.qq=o.qq.join(",")),o.wechat&&(o.wechat=o.wechat.join(",")),o.company&&(o.company=o.company.join(",")),o.telephone&&(o.telephone=o.telephone.join(",")),o.email&&(o.email=o.email.join(",")),o.tencent_id&&(o.tencent_id=o.tencent_id.join(","));var i=t.id?"客户激活"===t.title?"customer/ajax/"+t.id:"customer/edit/"+t.id:"customer/create";"客户激活"===t.title&&(o.action="active_customer"),t.$store.dispatch("GetConnect",{url:i,data:o}).then(function(e){t.$message.success(e.msg),t.$router.back(-1)}).catch(function(e){t.$message.error(e.msg)})}else t.$message.error("提交失败,请检查必填项")})},cancel:function(){this.$router.go(-1)}}},n=(o("VeBB"),o("KHd+")),s=Object(n.a)(l,function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("el-card",{staticClass:"box-1"},[o("div",{attrs:{slot:"header"},slot:"header"},[o("span",[e._v(e._s(e.title))])]),e._v(" "),o("el-form",{ref:"form",attrs:{model:e.form,rules:e.formRules,"label-width":"160px"}},[o("el-form-item",{attrs:{label:"客户昵称",prop:"name"}},[e.isDetails?o("div",[e._v(e._s(e.form.name))]):o("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"真实姓名"}},[e.isDetails?o("div",[e._v(e._s(e.form.realname))]):o("el-input",{model:{value:e.form.realname,callback:function(t){e.$set(e.form,"realname",t)},expression:"form.realname"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"公司"}},[e.isDetails?o("div",[e._v(e._s(e.form.company))]):e._e(),e._v(" "),e.isDetails?e._e():o("div",[e._l(e.form.company,function(t,i){return o("el-input",{key:i,attrs:{placeholder:"请输入公司名称"},model:{value:e.form.company[i],callback:function(t){e.$set(e.form.company,i,t)},expression:"form['company'][companyIndex]"}},[o("el-button",{attrs:{slot:"append",icon:"el-icon-delete"},on:{click:function(o){o.preventDefault(),e.removeItem("company",t)}},slot:"append"})],1)}),e._v(" "),o("el-button",{staticStyle:{"margin-top":"5px"},attrs:{type:"info",plain:""},on:{click:function(t){t.preventDefault(),e.addItem("company")}}},[e._v("新增公司名")])],2)]),e._v(" "),o("el-form-item",{attrs:{label:"职位"}},[e.isDetails?o("div",[e._v(e._s(e.form.position))]):o("el-input",{model:{value:e.form.position,callback:function(t){e.$set(e.form,"position",t)},expression:"form.position"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"客户手机",prop:"mobile"}},[e.isDetails?o("div",[e._v(e._s(e.form.mobile))]):o("el-input",{attrs:{placeholder:"请输入主要手机号码"},model:{value:e.form.mobile,callback:function(t){e.$set(e.form,"mobile",t)},expression:"form.mobile"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"其他手机"}},[e.isDetails?o("div",[e._v(e._s(e.form.spare_mobile))]):e._e(),e._v(" "),e.isDetails?e._e():o("div",[e._l(e.form.spare_mobile,function(t,i){return o("el-input",{key:i,attrs:{placeholder:"请输入其他联系手机号码"},model:{value:e.form.spare_mobile[i],callback:function(t){e.$set(e.form.spare_mobile,i,t)},expression:"form['spare_mobile'][mobileIndex]"}},[o("el-button",{attrs:{slot:"append",icon:"el-icon-delete"},on:{click:function(o){o.preventDefault(),e.removeItem("spare_mobile",t)}},slot:"append"})],1)}),e._v(" "),o("el-button",{staticStyle:{"margin-top":"5px"},attrs:{type:"info",plain:""},on:{click:function(t){t.preventDefault(),e.addItem("spare_mobile")}}},[e._v("新增手机号")])],2)]),e._v(" "),o("el-form-item",{attrs:{label:"座机"}},[e.isDetails?o("div",[e._v(e._s(e.form.telephone))]):e._e(),e._v(" "),e.isDetails?e._e():o("div",[e._l(e.form.telephone,function(t,i){return o("el-input",{key:i,attrs:{placeholder:"请输入座机"},model:{value:e.form.telephone[i],callback:function(t){e.$set(e.form.telephone,i,t)},expression:"form['telephone'][telephoneIndex]"}},[o("el-button",{attrs:{slot:"append",icon:"el-icon-delete"},on:{click:function(o){o.preventDefault(),e.removeItem("telephone",t)}},slot:"append"})],1)}),e._v(" "),o("el-button",{staticStyle:{"margin-top":"5px"},attrs:{type:"info",plain:""},on:{click:function(t){t.preventDefault(),e.addItem("telephone")}}},[e._v("新增座机")])],2)]),e._v(" "),o("el-form-item",{attrs:{label:"类型",prop:"type"}},[e.isDetails?o("div",[e._v(e._s(0===e.form.type?"个人":"企业"))]):o("el-select",{attrs:{placeholder:"请选择类型"},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[o("el-option",{attrs:{value:0,label:"个人"}}),e._v(" "),o("el-option",{attrs:{value:1,label:"企业"}})],1)],1),e._v(" "),o("el-form-item",{attrs:{label:"腾讯云ID"}},[e.isDetails?o("div",[e._v(e._s(e.form.qq))]):e._e(),e._v(" "),e.isDetails?e._e():o("div",[e._l(e.form.qq,function(t,i){return o("el-input",{key:i,attrs:{placeholder:"请输入腾讯云ID"},model:{value:e.form.qq[i],callback:function(t){e.$set(e.form.qq,i,t)},expression:"form['qq'][qqIndex]"}},[o("el-button",{attrs:{slot:"append",icon:"el-icon-delete"},on:{click:function(o){o.preventDefault(),e.removeItem("qq",t)}},slot:"append"})],1)}),e._v(" "),o("el-button",{staticStyle:{"margin-top":"5px"},attrs:{type:"info",plain:""},on:{click:function(t){t.preventDefault(),e.addItem("qq")}}},[e._v("新增腾讯云ID")])],2)]),e._v(" "),o("el-form-item",{attrs:{label:"微信"}},[e.isDetails?o("div",[e._v(e._s(e.form.wechat))]):e._e(),e._v(" "),e.isDetails?e._e():o("div",[e._l(e.form.wechat,function(t,i){return o("el-input",{key:i,attrs:{placeholder:"请输入微信号"},model:{value:e.form.wechat[i],callback:function(t){e.$set(e.form.wechat,i,t)},expression:"form['wechat'][wechatIndex]"}},[o("el-button",{attrs:{slot:"append",icon:"el-icon-delete"},on:{click:function(o){o.preventDefault(),e.removeItem("wechat",t)}},slot:"append"})],1)}),e._v(" "),o("el-button",{staticStyle:{"margin-top":"5px"},attrs:{type:"info",plain:""},on:{click:function(t){t.preventDefault(),e.addItem("wechat")}}},[e._v("新增微信")])],2)]),e._v(" "),o("el-form-item",{attrs:{label:"QQ"}},[e.isDetails?o("div",[e._v(e._s(e.form.tencent_id))]):e._e(),e._v(" "),e.isDetails?e._e():o("div",[e._l(e.form.tencent_id,function(t,i){return o("el-input",{key:i,attrs:{placeholder:"请输入QQ"},model:{value:e.form.tencent_id[i],callback:function(t){e.$set(e.form.tencent_id,i,t)},expression:"form['tencent_id'][tencentIdIndex]"}},[o("el-button",{attrs:{slot:"append",icon:"el-icon-delete"},on:{click:function(o){o.preventDefault(),e.removeItem("tencent_id",t)}},slot:"append"})],1)}),e._v(" "),o("el-button",{staticStyle:{"margin-top":"5px"},attrs:{type:"info",plain:""},on:{click:function(t){t.preventDefault(),e.addItem("tencent_id")}}},[e._v("新增QQ号")])],2)]),e._v(" "),o("el-form-item",{attrs:{label:"邮箱"}},[e.isDetails?o("div",[e._v(e._s(e.form.email))]):e._e(),e._v(" "),e.isDetails?e._e():o("div",[e._l(e.form.email,function(t,i){return o("el-input",{key:i,attrs:{placeholder:"请输入邮箱"},model:{value:e.form.email[i],callback:function(t){e.$set(e.form.email,i,t)},expression:"form['email'][emailIndex]"}},[o("el-button",{attrs:{slot:"append",icon:"el-icon-delete"},on:{click:function(o){o.preventDefault(),e.removeItem("email",t)}},slot:"append"})],1)}),e._v(" "),o("el-button",{staticStyle:{"margin-top":"5px"},attrs:{type:"info",plain:""},on:{click:function(t){t.preventDefault(),e.addItem("email")}}},[e._v("新增邮箱")])],2)]),e._v(" "),o("el-form-item",{attrs:{label:"客户来源",prop:"source"}},[e.isDetails?o("div",[e._v(e._s(e.form.source))]):o("el-select",{attrs:{filterable:"",placeholder:"请选择客户来源"},model:{value:e.form.source,callback:function(t){e.$set(e.form,"source",t)},expression:"form.source"}},e._l(e.sourceList,function(e){return o("el-option",{key:e.id,attrs:{label:e.source_name,value:e.source_name}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"备注"}},[e.isDetails?o("div",[o("pre",{staticClass:"pre"},[e._v(e._s(e.form.remarks))])]):o("el-input",{attrs:{type:"textarea",rows:"4"},model:{value:e.form.remarks,callback:function(t){e.$set(e.form,"remarks",t)},expression:"form.remarks"}})],1),e._v(" "),o("div",{staticStyle:{"text-align":"center"}},[e.isDetails?o("el-button",{attrs:{type:"primary"},on:{click:e.toModify}},[e._v("编辑")]):o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("form")}}},[e._v("确定")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.cancel}},[e._v("取消")])],1)],1),e._v(" "),o("h5",{staticClass:"margin-top-20"},[e._v("● 修改历史")]),e._v(" "),o("el-collapse",{model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},e._l(e.updateLog,function(t,i){return o("el-collapse-item",{key:i,attrs:{title:t.created_at+"（ 修改人："+t.u_name+" ）",name:i}},[o("el-card",[o("el-form",{attrs:{"label-width":"160px"}},[o("el-form-item",{attrs:{label:"客户昵称"}},[e._v(e._s(t.c_info.name))]),e._v(" "),o("el-form-item",{attrs:{label:"真实姓名"}},[e._v(e._s(t.c_info.realname))]),e._v(" "),o("el-form-item",{attrs:{label:"公司"}},[e._v(e._s(t.c_info.company))]),e._v(" "),o("el-form-item",{attrs:{label:"职位"}},[e._v(e._s(t.c_info.position))]),e._v(" "),o("el-form-item",{attrs:{label:"客户手机"}},[e._v(e._s(t.c_info.mobile))]),e._v(" "),o("el-form-item",{attrs:{label:"类型"}},[e._v(e._s(0===t.c_info.type?"个人":"企业"))]),e._v(" "),o("el-form-item",{attrs:{label:"腾讯云ID"}},[e._v(e._s(t.c_info.qq))]),e._v(" "),o("el-form-item",{attrs:{label:"微信"}},[e._v(e._s(t.c_info.wechat))]),e._v(" "),o("el-form-item",{attrs:{label:"邮箱"}},[e._v(e._s(t.c_info.email))]),e._v(" "),o("el-form-item",{attrs:{label:"客户来源"}},[e._v(e._s(t.c_info.source))]),e._v(" "),o("el-form-item",{attrs:{label:"备注"}},[e._v(e._s(t.c_info.remarks))])],1)],1)],1)}))],1)],1)},[],!1,null,"ad347490",null);s.options.__file="modify.vue";t.default=s.exports},nxfw:function(e,t,o){}}]);