(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-7032"],{"4xLL":function(e,t,i){"use strict";var r=i("FjEG");i.n(r).a},FjEG:function(e,t,i){},yZvD:function(e,t,i){"use strict";i.r(t);var r=i("zAZ/"),a={data:function(){return{searchTerms:{searchValue:""},dialogVisible:!1,adminList:[],form:{id:"",cid:0,name:"",admin_id:""},rules:{name:[{required:!0,message:"请输入服务范围名称",trigger:"change"}]},tableMaxHeight:document.documentElement.clientHeight-280,tableLoading:!1,currentPage:1,pageSize:this.$store.getters.userInfo.pageSize,pageSizes:[10,20,50,100,1e3],total:0,tableData:[]}},created:function(){this.getData(),this.getUsersList()},methods:{handleCurrentChange:r.c,handleSizeChange:r.d,handleSortChange:r.e,getData:function(e){var t=this;this.tableLoading=!0,e||(e={});var i={pageNo:this.currentPage,pageSize:this.pageSize,cid:0,search:this.searchTerms.searchValue};e.sortName&&(i.sortName=e.sortName),e.sortOrder&&(i.sortOrder=e.sortOrder),this.$store.dispatch("GetConnect",{url:"workorder/streetList",data:i}).then(function(e){t.tableData=e.data.rows,t.total=e.data.total,t.tableLoading=!1}).catch(function(e){t.tableLoading=!1,t.$message.error(e.msg+",请刷新或联系管理员")})},getUsersList:function(){var e=this;this.$store.dispatch("GetConnect",{url:"user/admin-list"}).then(function(t){e.adminList=t.data.list[0].personnel}).catch(function(t){e.$message.error(t.msg+",请刷新或联系管理员")})},toServiceArea:function(e){this.isShow=!1,this.$router.push({path:"/workOrder/serviceArea",query:{id:e.id}})},toDelete:function(e){var t=this;this.$confirm("此操作将删除该服务范围, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var i="workorder/delStreetId/"+e.id;t.$store.dispatch("GetConnect",{url:i}).then(function(e){t.$message.success(e.msg),t.getData()}).catch(function(e){t.$message.error(e.msg)})})},toAdd:function(){this.form={},this.dialogVisible=!0,this.form.title="添加服务范围",this.form.cid=0},toEdit:function(e){this.form={},this.dialogVisible=!0,this.form={id:e.id,cid:0,name:e.name,admin_id:[]},""!==e.admin_id&&(this.form.admin_id=e.admin_id.split(",")),this.form.title="编辑服务范围"},submitDialog:function(e){var t=this;this.$refs[e].validate(function(e){if(e){var i=t.form.id?"workorder/updateStreet":"workorder/addStreetInfo",r=t.form;r.admin_id=r.admin_id.join(","),t.$store.dispatch("GetConnect",{url:i,data:r}).then(function(e){t.dialogVisible=!1,t.$message.success(e.msg),t.getData()}).catch(function(e){t.$message.error(e.msg+",请刷新或联系管理员!")})}else t.$message.error("提交失败,请检查必填项")})},resetDialog:function(e){this.$refs[e].resetFields()},toExportData:function(){this.downloadLoading=!0;var e=this.$store.getters.serverUrl+"/admin/workorder/streetToExcel?token="+this.$store.getters.token;window.open(e),this.downloadLoading=!1}}},n=(i("4xLL"),i("KHd+")),o=Object(n.a)(a,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container  bg-gray"},[i("el-row",{staticClass:"box-1"},[i("el-col",{attrs:{span:24}},[i("el-card",[i("div",{staticClass:"header"},[i("div",[e.queryMatch(46)?i("el-button",{staticClass:"bg-green",attrs:{type:"success",icon:"el-icon-circle-plus"},on:{click:e.toAdd}},[e._v("新增地区")]):e._e(),e._v(" "),i("el-button",{staticClass:"bg-green",attrs:{type:"primary",icon:"el-icon-download"},on:{click:e.toExportData}},[e._v("导出数据")])],1)]),e._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],attrs:{data:e.tableData,"max-height":e.tableMaxHeight,border:"","highlight-current-row":""},on:{"sort-change":e.handleSortChange}},[i("el-table-column",{attrs:{prop:"id",label:"ID","min-width":"80","header-align":"center",align:"center",sortable:""}}),e._v(" "),i("el-table-column",{attrs:{prop:"name",label:"服务范围","min-width":"260"}}),e._v(" "),i("el-table-column",{attrs:{prop:"admin_name",label:"负责人",width:"160","header-align":"center",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(t.row.admin_name||"--")+"\n            ")]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"操作","min-width":"200","header-align":"center",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-tooltip",{attrs:{content:"范围列表",placement:"top"}},[i("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-more",circle:""},on:{click:function(i){e.toServiceArea(t.row)}}})],1),e._v(" "),i("el-button",{staticClass:"bg-green",staticStyle:{"margin-left":"10px"},attrs:{type:"success",size:"small",icon:"el-icon-edit",circle:""},on:{click:function(i){e.toEdit(t.row)}}}),e._v(" "),i("el-button",{attrs:{type:"danger",size:"small",icon:"el-icon-delete",circle:""},on:{click:function(i){e.toDelete(t.row)}}})]}}])})],1),e._v(" "),i("el-pagination",{staticClass:"pagination",attrs:{"current-page":e.currentPage,"page-size":e.pageSize,"page-sizes":e.pageSizes,total:e.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"update:currentPage":function(t){e.currentPage=t},"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1)],1)],1),e._v(" "),i("el-dialog",{staticClass:"dialog",attrs:{visible:e.dialogVisible,title:e.form.title,width:"500px",center:""},on:{"update:visible":function(t){e.dialogVisible=t},close:function(t){e.resetDialog("form")}}},[i("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"120px"}},[i("el-form-item",{attrs:{label:"类型名称",prop:"name"}},[i("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"负责人",prop:"admin_id"}},[i("el-select",{staticClass:"select",attrs:{"multiple-limit":2,placeholder:"请选择负责人",clearable:"",filterable:"",multiple:""},model:{value:e.form.admin_id,callback:function(t){e.$set(e.form,"admin_id",t)},expression:"form.admin_id"}},e._l(e.adminList,function(e){return i("el-option",{key:e.id,attrs:{label:e.name,value:e.id+""}})}))],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitDialog("form")}}},[e._v("确 定")])],1)],1)],1)},[],!1,null,"27cc5e5e",null);o.options.__file="list.vue";t.default=o.exports},"zAZ/":function(e,t,i){"use strict";i.d(t,"e",function(){return n}),i.d(t,"c",function(){return o}),i.d(t,"d",function(){return s}),i.d(t,"a",function(){return l}),i.d(t,"f",function(){return c}),i.d(t,"b",function(){return d});var r=i("EJiy"),a=i.n(r);function n(e){var t=e.column,i=e.prop,r=e.order;this.order={column:t,prop:i,order:r},this.getData({sortName:i,sortOrder:r&&("ascending"===r?"asc":"desc")})}function o(e){this.getData(this.order?{sortName:this.order.prop,sortOrder:this.order.order&&("ascending"===this.order.order?"asc":"desc")}:{})}function s(e){this.$store.getters.userInfo.pageSize=e,this.pageSize=e,this.getData(this.order?{sortName:this.order.prop,sortOrder:this.order.order&&("ascending"===this.order.order?"asc":"desc")}:{})}function l(e){this.th[e].check=!this.th[e].check}function c(e,t){if(0===arguments.length)return null;var i=t||"{y}-{m}-{d} {h}:{i}:{s}",r=void 0;"object"===(void 0===e?"undefined":a()(e))?r=e:(10===(""+e).length&&(e=1e3*parseInt(e)),r=new Date(e));var n={y:r.getFullYear(),m:r.getMonth()+1,d:r.getDate(),h:r.getHours(),i:r.getMinutes(),s:r.getSeconds(),a:r.getDay()};return i.replace(/{(y|m|d|h|i|s|a)+}/g,function(e,t){var i=n[t];return"a"===t?["日","一","二","三","四","五","六"][i]:(e.length>0&&i<10&&(i="0"+i),i||0)})}function d(e){var t=e.substr(0,10);t=t.replace(/-/g,"/");var i=new Date(t),r=new Date;r=r.valueOf();var a=Math.ceil((i-r)/864e5);return 0===a?"今天":a>0&&a<30?a+"天":a>=30&&a<360?Math.ceil(a/30)+"月":a>=360?Math.ceil(a/360)+"年":"逾期"+Math.ceil((r-i)/864e5)+"天"}}}]);