(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-644c"],{"4r6F":function(e,t,r){"use strict";var a=r("CCwE");r.n(a).a},CCwE:function(e,t,r){},jX1a:function(e,t,r){"use strict";r.r(t);var a=r("P2sY"),i=r.n(a),o={data:function(){return{ImageUrl:"",title:"创建活动",fromId:"",dialogImageUrl:"",showImageDialog:!1,typeList:[],form:{date:[],stop_time:""},formRules:{name:[{required:!0,message:"请输入活动名称",trigger:"blur"}],explain:[{required:!0,message:"请输入活动简介",trigger:"blur"}],place:[{required:!0,message:"请输入活动地点",trigger:"blur"}],date:[{required:!0,message:"请选择活动时间",trigger:"blur"}],stop_time:[{required:!0,message:"请选择报名截止时间",trigger:"blur"}],host_party:[{required:!0,message:"请输入主办方",trigger:"blur"}],host_contact:[{required:!0,message:"请输入主办方电话",trigger:"blur"}],picture:[{required:!0,message:"请输入活动封面图",trigger:"blur"}],regulations:[{required:!0,message:"请输入活动规则",trigger:"blur"}],details:[{required:!0,message:"请输入活动详情",trigger:"blur"}],limit_number:[{required:!0,message:"请输入活动人数",trigger:"blur"}],activity_type_id:[{required:!0,message:"请选择活动类型id",trigger:"blur"}],audit_mode:[{required:!0,message:"请选择审核方式",trigger:"blur"}],notice:[{required:!0,message:"请选择通知方式",trigger:"blur"}]}}},watch:{},created:function(){this.fromId=this.$route.query.fromId||"",this.$route.query.id&&(this.form.id=this.$route.query.id||"",this.title="编辑活动"),this.getTypeList()},methods:{getTypeList:function(){var e=this;this.$store.dispatch("GetConnect",{url:"activity/getTypeList"}).then(function(t){e.typeList=t.data,(e.form.id||e.fromId)&&e.loadData()}).catch(function(t){e.$message.error(t.msg+",请刷新或联系管理员")})},loadData:function(){var e=this;console.log(this.fromId);var t="activity/getActivityInfo/"+(this.form.id||this.fromId);this.$store.dispatch("GetConnect",{url:t}).then(function(t){var r=i()({},t.data);r.date=[t.data.start_time,t.data.end_time],e.form=r}).catch(function(t){e.$message.error(t.msg+",请刷新或联系管理员")})},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(e){var r=t.form.id&&!t.fromId?"activity/updateActivity":"activity/addActivity",a=i()({},t.form);a.date&&0!==a.date.length&&(a.start_time=a.date[0],a.end_time=a.date[1]),t.$store.dispatch("GetConnect",{url:r,data:a}).then(function(e){t.$message.success(e.msg),t.$router.back(-1)}).catch(function(e){t.$message.error(e.msg)})}else t.$message.error("提交失败,请检查必填项")})},resetForm:function(e){this.$refs[e].resetFields()}}},l=(r("4r6F"),r("KHd+")),s=Object(l.a)(o,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container bg-gray"},[r("el-card",{staticClass:"box-1"},[r("div",{attrs:{slot:"header"},slot:"header"},[r("span",[e._v(e._s(e.title))])]),e._v(" "),r("el-form",{ref:"form",attrs:{model:e.form,rules:e.formRules,"label-width":"160px"}},[r("el-form-item",{attrs:{label:"活动名称",prop:"name"}},[r("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"副标题",prop:"explain"}},[r("el-input",{model:{value:e.form.explain,callback:function(t){e.$set(e.form,"explain",t)},expression:"form.explain"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"活动地点",prop:"place"}},[r("el-input",{model:{value:e.form.place,callback:function(t){e.$set(e.form,"place",t)},expression:"form.place"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"活动时间",prop:"date"}},[r("el-date-picker",{staticClass:"picker",attrs:{type:"datetimerange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.form.date,callback:function(t){e.$set(e.form,"date",t)},expression:"form['date']"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"报名截止",prop:"stop_time"}},[r("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:e.form.stop_time,callback:function(t){e.$set(e.form,"stop_time",t)},expression:"form['stop_time']"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"主办方",prop:"host_party"}},[r("el-input",{model:{value:e.form.host_party,callback:function(t){e.$set(e.form,"host_party",t)},expression:"form['host_party']"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"联系方式",prop:"host_contact"}},[r("el-input",{model:{value:e.form.host_contact,callback:function(t){e.$set(e.form,"host_contact",t)},expression:"form['host_contact']"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"活动图片",prop:"picture"}},[r("div",{staticClass:"remark"},[e._v("*注:为保证显示效果,请上传一张375px*214px的图片")]),e._v(" "),r("ws-upload-single-img",{attrs:{path:e.form.picture?e.ImageUrl+e.form.picture:""},model:{value:e.form.picture,callback:function(t){e.$set(e.form,"picture",t)},expression:"form['picture']"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"活动须知",prop:"regulations"}},[r("el-input",{attrs:{rows:3,type:"textarea"},model:{value:e.form.regulations,callback:function(t){e.$set(e.form,"regulations",t)},expression:"form['regulations']"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"活动详情",prop:"details"}},[r("ws-editor",{model:{value:e.form.details,callback:function(t){e.$set(e.form,"details",t)},expression:"form['details']"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"人数限制",prop:"limit_number"}},[r("el-input",{model:{value:e.form.limit_number,callback:function(t){e.$set(e.form,"limit_number",t)},expression:"form['limit_number']"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"活动类型",prop:"activity_type_id"}},[r("el-select",{attrs:{placeholder:"请选择商品",filterable:""},model:{value:e.form.activity_type_id,callback:function(t){e.$set(e.form,"activity_type_id",t)},expression:"form['activity_type_id']"}},e._l(e.typeList,function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id+""}})}))],1),e._v(" "),r("el-form-item",{attrs:{label:"审核方式",prop:"audit_mode"}},[r("el-radio-group",{model:{value:e.form.audit_mode,callback:function(t){e.$set(e.form,"audit_mode",t)},expression:"form['audit_mode']"}},[r("el-radio",{attrs:{label:0}},[e._v("手动通过")]),e._v(" "),r("el-radio",{attrs:{label:1}},[e._v("自动审核")])],1)],1),e._v(" "),r("el-form-item",{attrs:{label:"通知方式",prop:"notice"}},[r("el-radio-group",{model:{value:e.form.notice,callback:function(t){e.$set(e.form,"notice",t)},expression:"form['notice']"}},[r("el-radio",{attrs:{label:1}},[e._v("微信")]),e._v(" "),r("el-radio",{attrs:{label:2}},[e._v("短信")]),e._v(" "),r("el-radio",{attrs:{label:3}},[e._v("短信&微信")])],1)],1),e._v(" "),r("div",{staticStyle:{"text-align":"center"}},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("form")}}},[e._v("保存")])],1)],1)],1)],1)},[],!1,null,"7d281f4e",null);s.options.__file="create.vue";t.default=s.exports}}]);