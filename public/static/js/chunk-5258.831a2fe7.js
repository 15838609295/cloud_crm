(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-5258"],{Yfch:function(e,t,r){"use strict";function o(e){return/^(https?|ftp):\/\/([a-zA-Z0-9.-]+(:[a-zA-Z0-9.&%$-]+)*@)*((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])){3}|([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+\.(com|edu|gov|int|mil|net|org|biz|arpa|info|name|pro|aero|coop|museum|[a-zA-Z]{2}))(:[0-9]+)*(\/($|[a-zA-Z0-9.,?'\\+&%$#=~_-]+))*$/.test(e)}function s(e){return/^[A-Za-z0-9\u4e00-\u9fa5]+$/.test(e)&&!/^\d+$/.test(e)}function a(e){return/^[A-Za-z0-9\u4e00-\u9fa5]+$/.test(e)}function n(e,t){for(var r=e.split(""),o=0;o<r.length;o++)o>t-1&&o<r.length-t&&(r[o]="*");return r.join("")}r.d(t,"d",function(){return o}),r.d(t,"c",function(){return s}),r.d(t,"b",function(){return a}),r.d(t,"a",function(){return n})},gvHd:function(e,t,r){"use strict";var o=r("vRyw");r.n(o).a},vRyw:function(e,t,r){},vhQI:function(e,t,r){"use strict";r.r(t);var o=r("P2sY"),s=r.n(o),a=r("Yfch"),n={data:function(){return{title:"",ImageUrl:"",usersList:[],goodsList:[],form:{name:"",phone:"",goods:"",price:"",order_num:"",date:"",term:"",afterSale:"",after_sale_id:"",remark:"",sale_proof:""},formRules:{goods_name:[{required:!0,message:"请选择商品名称",trigger:"blur"}],goods_money:[{required:!0,message:"请输入商品金额",trigger:"blur"}],order_number:[{required:!0,message:"请输入订单号",trigger:"blur"}],buy_time:[{required:!0,message:"请选择购买时间",trigger:"blur"}],buy_length:[{required:!0,message:"请选择购买时长",trigger:"blur"}],sale_proof:[{required:!0,message:"请上传销售凭证",trigger:"blur"}]}}},watch:{},created:function(){this.id=this.$route.query.id,this.getCustomerInfo(this.$route.query.id),this.getGoodsList(),this.getUsersList()},methods:{getCustomerInfo:function(e){var t=this,r="member/detail/"+e;this.$store.dispatch("GetConnect",{url:r}).then(function(e){s()(t.form,e.data),t.form.sale_proof="",t.form.after_sale_id=parseInt(t.$store.getters.id)}).catch(function(e){t.$message.error(e.msg+",请刷新或联系管理员")})},getGoodsList:function(){var e=this;this.$store.dispatch("GetConnect",{url:"goods/all-list"}).then(function(t){e.goodsList=t.data}).catch(function(t){e.$message.error(t.msg+",请刷新或联系管理员")})},getUsersList:function(){var e=this;this.$store.dispatch("GetConnect",{url:"user/all-list"}).then(function(t){e.usersList=t.data}).catch(function(t){e.$message.error(t.msg+",请刷新或联系管理员")})},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(e){if(t.form.goods_money<=0)return void t.$message.error("商品金额不能为负数和0");if(!Object(a.b)(t.form.order_number))return void t.$message.error("订单号不能包含特殊字符");var r=t.form;if(r.sale_proof&&r.sale_proof.length>0){var o="member/addAchievement/"+t.id;t.$store.dispatch("GetConnect",{url:o,data:r}).then(function(e){t.$message.success(e.msg),t.$router.back(-1)}).catch(function(e){t.$message.error(e.msg)})}else t.$message.error("提交失败,请上传销售凭证")}else t.$message.error("提交失败,请检查必填项")})},resetForm:function(e){this.$refs[e].resetFields()}}},i=(r("gvHd"),r("KHd+")),l=Object(i.a)(n,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-card",{staticClass:"box-1"},[r("div",{attrs:{slot:"header"},slot:"header"},[r("span",[e._v("业绩录入")])]),e._v(" "),r("el-form",{ref:"form",attrs:{model:e.form,rules:e.formRules,"label-width":"160px"}},[r("el-form-item",{attrs:{label:"客户名称"}},[e._v("\n        "+e._s(e.form.name)+"\n      ")]),e._v(" "),r("el-form-item",{attrs:{label:"客户手机"}},[e._v("\n        "+e._s(e.form.mobile)+"\n      ")]),e._v(" "),r("el-form-item",{attrs:{label:"商品名称",prop:"goods_name"}},[r("el-select",{attrs:{placeholder:"请选择商品",filterable:""},model:{value:e.form.goods_name,callback:function(t){e.$set(e.form,"goods_name",t)},expression:"form.goods_name"}},e._l(e.goodsList,function(e){return r("el-option",{key:e.id,attrs:{label:e.goods_name,value:e.goods_name}})}))],1),e._v(" "),r("el-form-item",{attrs:{label:"商品金额",prop:"goods_money"}},[r("el-input",{attrs:{type:"number"},model:{value:e.form.goods_money,callback:function(t){e.$set(e.form,"goods_money",t)},expression:"form.goods_money"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"订单号",prop:"order_number"}},[r("el-input",{model:{value:e.form.order_number,callback:function(t){e.$set(e.form,"order_number",t)},expression:"form.order_number"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"购买时间",prop:"buy_time"}},[r("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:e.form.buy_time,callback:function(t){e.$set(e.form,"buy_time",t)},expression:"form.buy_time"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"购买时长",prop:"buy_length"}},[r("el-input",{model:{value:e.form.buy_length,callback:function(t){e.$set(e.form,"buy_length",t)},expression:"form.buy_length"}}),e._v(" "),r("div",{staticClass:"remark"},[e._v("*注:时长是按月计算")])],1),e._v(" "),r("el-form-item",{attrs:{label:"售后人员"}},[r("el-select",{attrs:{placeholder:"请选择售后人员",filterable:""},model:{value:e.form.after_sale_id,callback:function(t){e.$set(e.form,"after_sale_id",t)},expression:"form.after_sale_id"}},e._l(e.usersList,function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),r("el-form-item",{attrs:{label:"备注"}},[r("el-input",{attrs:{type:"textarea"},model:{value:e.form.remarks,callback:function(t){e.$set(e.form,"remarks",t)},expression:"form.remarks"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"销售凭证",prop:"sale_proof"}},[r("div",{staticClass:"remark"},[e._v("*注:最多传三张图")]),e._v(" "),r("ws-upload-multiple-img",{attrs:{path:e.form.pic_list_url,limit:3},model:{value:e.form.sale_proof,callback:function(t){e.$set(e.form,"sale_proof",t)},expression:"form['sale_proof']"}})],1),e._v(" "),r("div",{staticStyle:{"text-align":"center"}},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("form")}}},[e._v("保存")])],1)],1)],1)],1)},[],!1,null,"17fd2115",null);l.options.__file="achievement.vue";t.default=l.exports}}]);