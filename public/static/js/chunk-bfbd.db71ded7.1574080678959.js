(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-bfbd"],{Oijf:function(t,e,a){"use strict";a.r(e);var i=a("zAZ/"),n={data:function(){return{pagePath:"",title:"",imageUrl:"",activeName:"first",info:{},dialogVisible:!1,form:{cause:""},rules:{cause:[{required:!0,message:"请输入取消原因",trigger:"change"}]},tableMaxHeight:document.documentElement.clientHeight-380,tableLoading:!1,currentPage:1,pageSize:this.$store.getters.userInfo.pageSize,pageSizes:[10,20,50,100,1e3],total:0,tableData:[]}},watch:{},created:function(){this.pagePath=this.$route.path,this.id=this.$route.query.id||"",this.getActiveDetails()},methods:{handleCurrentChange:i.c,handleSizeChange:i.d,handleSortChange:i.e,parseTime:i.f,getActiveDetails:function(){var t=this,e="activity/getActivityInfo/"+this.id;this.$store.dispatch("GetConnect",{url:e}).then(function(e){t.info=e.data,t.getData()}).catch(function(e){t.$message.error(e.msg+",请刷新或联系管理员")})},handleClick:function(){this.currentPage=1,this.getData()},getData:function(){var t=this,e="";"first"===this.activeName?e="activity/entryList/"+this.id:"second"===this.activeName&&(e="activity/commentList"),this.tableLoading=!0;var a={id:this.id,activityId:this.id,page_no:this.currentPage,page_size:this.pageSize};this.$store.dispatch("GetConnect",{url:e,data:a}).then(function(e){t.tableData=e.data.rows,t.total=e.data.total,t.tableLoading=!1}).catch(function(e){t.tableLoading=!1,t.$message.error(e.msg+",请刷新或联系管理员")})},submitDialog:function(t){var e=this;this.$refs[t].validate(function(t){if(t){var a="activity/cancelActivity/"+e.id,i=e.form;e.$store.dispatch("GetConnect",{url:a,data:i}).then(function(t){e.dialogVisible=!1,e.$message.success(t.msg),e.getActiveDetails()}).catch(function(t){e.$message.error(t.msg+",请刷新或联系管理员!")})}})},resetDialog:function(t){this.$refs[t].resetFields()},toInfo:function(t){this.$router.push({path:"/activity/info",query:{id:t}})},toSetStatus:function(t,e){var a=this,i={id:t.id,status:e};this.$store.dispatch("GetConnect",{url:"activity/verifyRefuse",data:i}).then(function(t){a.$message.success(t.msg),a.getData()}).catch(function(t){a.$message.error(t.msg+",请刷新或联系管理员!")})},toSetStatusComment:function(t,e){var a=this,i={id:t.id,status:e};this.$store.dispatch("GetConnect",{url:"activity/checkComment",data:i}).then(function(t){a.$message.success(t.msg),a.getData()}).catch(function(t){a.$message.error(t.msg+",请刷新或联系管理员!")})},toDelete:function(t){var e=this,a="activity/delComment/"+t.id;this.$store.dispatch("GetConnect",{url:a}).then(function(t){e.$message.success(t.msg),e.getData()}).catch(function(t){e.$message.error(t.msg+",请刷新或联系管理员!")})},toExportMember:function(){window.open(this.$store.getters.serverUrl+"/admin/activity/toExcel?token="+this.$store.getters.token+"&id="+this.id)}}},s=(a("zcnv"),a("otTa"),a("KHd+")),r=Object(s.a)(n,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container bg-gray"},[a("el-card",{staticClass:"box-1"},[a("div",{staticClass:"header",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("活动详情")])]),t._v(" "),a("div",{staticClass:"box-2"},[a("img",{staticClass:"image",attrs:{src:t.imageUrl+t.info.picture}}),t._v(" "),a("div",{staticClass:"content"},[a("div",{staticClass:"name"},[t._v(t._s(t.info.name))]),t._v(" "),a("div",{staticClass:"tab"},[a("span",[t._v("赞: "+t._s(t.info.fabulousNumber))]),t._v(" "),a("span",[t._v("    收藏: "+t._s(t.info.collectNumber))])]),t._v(" "),a("div",{staticClass:"info"},[t._v("活动地点"),a("span",[t._v(t._s(t.info.place))])]),t._v(" "),a("div",{staticClass:"info"},[t._v("活动时间"),a("span",[t._v(t._s(t.info.start_time))])]),t._v(" "),a("div",{staticClass:"info"},[t._v("截止报名"),a("span",[t._v(t._s(t.info.stop_time))])]),t._v(" "),a("div",{staticClass:"info"},[t._v("发起人    "),a("span",[t._v(t._s(t.info.host_party))])]),t._v(" "),a("div",{staticClass:"info"},[t._v("人数上限"),a("span",[t._v(t._s(t.info.limit_number))])]),t._v(" "),a("div",{staticClass:"info"},[t._v("联系方式"),a("span",[t._v(t._s(t.info.host_contact))])]),t._v(" "),a("div",{staticClass:"info"},[t._v("更新时间"),a("span",[t._v(t._s(t.info.updated_at))])]),t._v(" "),a("div",{staticClass:"info"},[t._v("已报名    "),a("span",[t._v(t._s(t.info.number))])])])]),t._v(" "),a("div",{staticClass:"btn-box"},[2===t.info.activity_status?a("el-button",{attrs:{type:"danger"}},[t._v("已结束")]):t._e(),t._v(" "),0===t.info.activity_status?a("el-button",{attrs:{type:"danger"}},[t._v("已取消")]):t._e(),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.toInfo(t.info.id)}}},[t._v("详情")]),t._v(" "),1===t.info.activity_status?a("el-button",{attrs:{type:"danger"},on:{click:function(e){t.dialogVisible=!0}}},[t._v("取消活动")]):t._e(),t._v(" "),a("el-button",{attrs:{type:"info"},on:{click:t.toExportMember}},[t._v("导出参加者")])],1),t._v(" "),a("div",{staticClass:"box-3"},[a("el-tabs",{staticClass:"activity-tabs",on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"待审核用户",name:"first"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading,expression:"tableLoading"}],attrs:{data:t.tableData,border:"","highlight-current-row":""},on:{"sort-change":t.handleSortChange}},[a("el-table-column",{attrs:{prop:"id",label:"ID",width:"80","header-align":"center",align:"center",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{prop:"member_name",label:"用户名","min-width":"140","header-align":"center",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"mobile",label:"手机号码","min-width":"160","header-align":"center",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"status",label:"状态",width:"150","header-align":"center",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[2===e.row.status?a("el-tag",{attrs:{type:"success"}},[t._v("审核通过")]):t._e(),t._v(" "),1===e.row.status?a("el-tag",{attrs:{type:"info"}},[t._v("等待审核")]):t._e(),t._v(" "),4===e.row.status?a("el-tag",{attrs:{type:"danger"}},[t._v("不通过")]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"200","header-align":"center",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[1===e.row.status?a("div",[a("el-tooltip",{attrs:{content:"通过",placement:"top"}},[a("el-button",{staticClass:"bg-green",attrs:{type:"success",size:"small",icon:"el-icon-check",circle:""},on:{click:function(a){t.toSetStatus(e.row,1)}}})],1),t._v(" "),a("el-tooltip",{attrs:{content:"不通过",placement:"top"}},[a("el-button",{attrs:{type:"info",size:"small",icon:"el-icon-close",circle:""},on:{click:function(a){t.toSetStatus(e.row,2)}}})],1)],1):t._e()]}}])})],1),t._v(" "),a("el-pagination",{staticClass:"pagination",attrs:{"current-page":t.currentPage,"page-size":t.pageSize,"page-sizes":t.pageSizes,total:t.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"update:currentPage":function(e){t.currentPage=e},"current-change":t.handleCurrentChange,"size-change":t.handleSizeChange}})],1),t._v(" "),a("el-tab-pane",{attrs:{label:"待审核评论",name:"second"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading,expression:"tableLoading"}],attrs:{data:t.tableData,border:"","highlight-current-row":""},on:{"sort-change":t.handleSortChange}},[a("el-table-column",{attrs:{prop:"id",label:"ID",width:"80","header-align":"center",align:"center",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"用户名",width:"140","header-align":"center",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"mobile",label:"手机号码",width:"160","header-align":"center",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"content",label:"评论内容","min-width":"220","header-align":"center",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:"状态",width:"150","header-align":"center",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[1===e.row.status?a("el-tag",{attrs:{type:"success"}},[t._v("审核通过")]):t._e(),t._v(" "),0===e.row.status?a("el-tag",{attrs:{type:"info"}},[t._v("等待审核")]):t._e(),t._v(" "),2===e.row.status?a("el-tag",{attrs:{type:"info"}},[t._v("审核不通过")]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"180","header-align":"center",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tooltip",{attrs:{content:"通过",placement:"top"}},[a("el-button",{staticClass:"bg-green",attrs:{type:"success",size:"small",icon:"el-icon-check",circle:""},on:{click:function(a){t.toSetStatusComment(e.row,1)}}})],1),t._v(" "),a("el-tooltip",{attrs:{content:"不通过",placement:"top"}},[a("el-button",{attrs:{type:"info",size:"small",icon:"el-icon-close",circle:""},on:{click:function(a){t.toSetStatusComment(e.row,2)}}})],1),t._v(" "),a("el-tooltip",{attrs:{content:"删除",placement:"top"}},[a("el-button",{attrs:{type:"danger",size:"small",icon:"el-icon-delete",circle:""},on:{click:function(a){t.toDelete(e.row)}}})],1)]}}])})],1),t._v(" "),a("el-pagination",{staticClass:"pagination",attrs:{"current-page":t.currentPage,"page-size":t.pageSize,"page-sizes":t.pageSizes,total:t.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"update:currentPage":function(e){t.currentPage=e},"current-change":t.handleCurrentChange,"size-change":t.handleSizeChange}})],1)],1)],1)]),t._v(" "),a("el-dialog",{staticClass:"dialog",attrs:{visible:t.dialogVisible,title:"取消活动",width:"500px",center:""},on:{"update:visible":function(e){t.dialogVisible=e},close:function(e){t.resetDialog("form")}}},[a("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"取消原因",prop:"cause"}},[a("el-input",{attrs:{type:"textarea",rows:"5",autofocus:""},model:{value:t.form.cause,callback:function(e){t.$set(t.form,"cause",e)},expression:"form.cause"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitDialog("form")}}},[t._v("确 定")])],1)],1)],1)},[],!1,null,"5c439562",null);r.options.__file="details.vue";e.default=r.exports},hCXH:function(t,e,a){},otTa:function(t,e,a){"use strict";var i=a("hCXH");a.n(i).a},rQrz:function(t,e,a){},"zAZ/":function(t,e,a){"use strict";a.d(e,"e",function(){return s}),a.d(e,"c",function(){return r}),a.d(e,"d",function(){return o}),a.d(e,"a",function(){return c}),a.d(e,"f",function(){return l}),a.d(e,"b",function(){return u});var i=a("EJiy"),n=a.n(i);function s(t){var e=t.column,a=t.prop,i=t.order;this.order={column:e,prop:a,order:i},this.getData({sortName:a,sortOrder:i&&("ascending"===i?"asc":"desc")})}function r(t){this.getData(this.order?{sortName:this.order.prop,sortOrder:this.order.order&&("ascending"===this.order.order?"asc":"desc")}:{})}function o(t){this.$store.getters.userInfo.pageSize=t,this.pageSize=t,this.getData(this.order?{sortName:this.order.prop,sortOrder:this.order.order&&("ascending"===this.order.order?"asc":"desc")}:{})}function c(t){this.th[t].check=!this.th[t].check}function l(t,e){if(0===arguments.length)return null;var a=e||"{y}-{m}-{d} {h}:{i}:{s}",i=void 0;"object"===(void 0===t?"undefined":n()(t))?i=t:(10===(""+t).length&&(t=1e3*parseInt(t)),i=new Date(t));var s={y:i.getFullYear(),m:i.getMonth()+1,d:i.getDate(),h:i.getHours(),i:i.getMinutes(),s:i.getSeconds(),a:i.getDay()};return a.replace(/{(y|m|d|h|i|s|a)+}/g,function(t,e){var a=s[e];return"a"===e?["日","一","二","三","四","五","六"][a]:(t.length>0&&a<10&&(a="0"+a),a||0)})}function u(t){var e=t.substr(0,10);e=e.replace(/-/g,"/");var a=new Date(e),i=new Date;i=i.valueOf();var n=Math.ceil((a-i)/864e5);return 0===n?"今天":n>0&&n<30?n+"天":n>=30&&n<360?Math.ceil(n/30)+"月":n>=360?Math.ceil(n/360)+"年":"逾期"+Math.ceil((i-a)/864e5)+"天"}},zcnv:function(t,e,a){"use strict";var i=a("rQrz");a.n(i).a}}]);