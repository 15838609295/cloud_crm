(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-0e90"],{"Knb+":function(e,t,a){},VEYs:function(e,t,a){"use strict";a.r(t);var i=a("P2sY"),r=a.n(i),n={data:function(){return{examPaperList:[],teamList:{admin:[],member:[]},isCheckAllPerson:!1,checkAllAdminTeam:!1,checkAllMemberTeam:!1,checkedAdminTeam:[],checkedMemberTeam:[],adminTeamList:[],memberTeamList:[],isAdminIndeterminate:!1,isMemberIndeterminate:!1,form:{name:"",testId:"",time:[],cover:"",qualifiedScore:"",totalScore:0,limitTime:"",number:1,examineeId:[],isRanking:!0,cuttingScreen:0,cuttingScreenNumber:0,isCopy:0,isSort:0,explain:"",notice:[],rule:[]},formRules:{name:[{required:!0,message:"请输入考试名称",trigger:"change"}]}}},watch:{},created:function(){this.id=this.$route.query.id,this.getExamPaperList(),this.getTeamList()},methods:{handleCheckAllAdminChange:function(e){this.checkedAdminTeam=e?this.adminTeamList:[],this.isAdminIndeterminate=!1},handleCheckAllMemberChange:function(e){this.checkedMemberTeam=e?this.memberTeamList:[],this.isMemberIndeterminate=!1},handleCheckedMemberChange:function(e){var t=e.length;this.checkAllMemberTeam=t===this.memberTeamList.length,this.isMemberIndeterminate=t>0&&t<this.memberTeamList.length},handleCheckedAdminChange:function(e){var t=e.length;this.checkAllAdminTeam=t===this.adminTeamList.length,this.isAdminIndeterminate=t>0&&t<this.adminTeamList.length},getExamPaperList:function(){var e=this;this.$store.dispatch("GetConnect",{url:"exam/testPaperNoPage"}).then(function(t){e.examPaperList=t.data}).catch(function(t){e.$message.error(t.msg+",请刷新或联系管理员")})},bindSelectChange:function(e){for(var t=0;t<this.examPaperList.length;t++)this.examPaperList[t].id===e&&(this.form.totalScore=this.examPaperList[t].fraction)},getTeamList:function(){var e=this;this.$store.dispatch("GetConnect",{url:"exam/examineeGroupList"}).then(function(t){e.teamList=t.data,e.adminTeamList=t.data.admin,e.memberTeamList=t.data.member}).catch(function(t){e.$message.error(t.msg+",请刷新或联系管理员")})},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(e){var a=r()({},t.form);a.startTime=a.time[0],a.endTime=a.time[1];for(var i=0;i<a.rule.length;i++)1===a.rule[i]?a.cuttingScreen=1:2===a.rule[i]?a.isSort=1:3===a.rule[i]&&(a.isCopy=1);t.isCheckAllPerson?a.examineeId=[t.teamList.all[0]]:a.examineeId=t.checkedAdminTeam.concat(t.checkedMemberTeam);for(var n=[],l=0;l<a.examineeId.length;l++)n.push(a.examineeId[l].id);a.examineeId=n.join(",");t.$store.dispatch("GetConnect",{url:"exam/addExamData",data:a}).then(function(e){t.$message.success(e.msg),t.$router.back(-1)}).catch(function(e){t.$message.error(e.msg)})}else t.$message.error("提交失败,请检查必填项")})},resetForm:function(e){this.$refs[e].resetFields()}}},l=(a("qdgl"),a("KHd+")),m=Object(l.a)(n,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container bg-gray"},[a("el-card",{staticClass:"box-1"},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",[e._v("创建考试")])]),e._v(" "),a("el-form",{ref:"form",attrs:{model:e.form,rules:e.formRules,"label-width":"160px"}},[a("el-form-item",{attrs:{label:"考试标题"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"选择试卷"}},[a("el-select",{staticClass:"select",attrs:{placeholder:"选择试卷",clearable:""},on:{change:e.bindSelectChange},model:{value:e.form.testId,callback:function(t){e.$set(e.form,"testId",t)},expression:"form.testId"}},e._l(e.examPaperList,function(e){return a("el-option",{key:e.id,attrs:{value:e.id,label:e.name}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"考试时间"}},[a("el-date-picker",{attrs:{type:"datetimerange","is-range":"",clearable:"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd HH:mm"},model:{value:e.form.time,callback:function(t){e.$set(e.form,"time",t)},expression:"form['time']"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"合格分数"}},[a("el-input-number",{attrs:{max:e.form.totalScore},model:{value:e.form.qualifiedScore,callback:function(t){e.$set(e.form,"qualifiedScore",t)},expression:"form.qualifiedScore"}}),a("label",{staticStyle:{color:"red","margin-left":"20px"}},[e._v("当前试卷总分"+e._s(e.form.totalScore))])],1),e._v(" "),a("el-form-item",{attrs:{label:"封面"}},[a("ws-upload-single-img",{attrs:{path:e.form.cover},model:{value:e.form.cover,callback:function(t){e.$set(e.form,"cover",t)},expression:"form['cover']"}}),e._v(" "),a("div",{staticClass:"remark"},[e._v("*注:为保证显示效果,请上传一张210px*210px的图片,支持.png, .jpg, .gif格式")])],1),e._v(" "),a("el-form-item",{attrs:{label:"考试说明"}},[a("ws-editor",{model:{value:e.form.explain,callback:function(t){e.$set(e.form,"explain",t)},expression:"form['explain']"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"答题时长"}},[a("el-input-number",{model:{value:e.form.limitTime,callback:function(t){e.$set(e.form,"limitTime",t)},expression:"form.limitTime"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"考试次数"}},[a("el-input-number",{model:{value:e.form.number,callback:function(t){e.$set(e.form,"number",t)},expression:"form.number"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"考试对象"}},[a("div",[a("el-checkbox",{model:{value:e.isCheckAllPerson,callback:function(t){e.isCheckAllPerson=t},expression:"isCheckAllPerson"}},[a("b",[e._v("所有人")])])],1),e._v(" "),a("el-checkbox",{attrs:{indeterminate:e.isAdminIndeterminate},on:{change:e.handleCheckAllAdminChange},model:{value:e.checkAllAdminTeam,callback:function(t){e.checkAllAdminTeam=t},expression:"checkAllAdminTeam"}},[a("b",[e._v("员工分组")])]),e._v(" "),a("el-checkbox-group",{on:{change:e.handleCheckedAdminChange},model:{value:e.checkedAdminTeam,callback:function(t){e.checkedAdminTeam=t},expression:"checkedAdminTeam"}},e._l(e.teamList.admin,function(t){return a("el-checkbox",{key:t.id,attrs:{label:t}},[e._v(e._s(t.name))])})),e._v(" "),a("el-checkbox",{attrs:{indeterminate:e.isMemberIndeterminate},on:{change:e.handleCheckAllMemberChange},model:{value:e.checkAllMemberTeam,callback:function(t){e.checkAllMemberTeam=t},expression:"checkAllMemberTeam"}},[a("b",[e._v("客户分组")])]),e._v(" "),a("el-checkbox-group",{on:{change:e.handleCheckedMemberChange},model:{value:e.checkedMemberTeam,callback:function(t){e.checkedMemberTeam=t},expression:"checkedMemberTeam"}},e._l(e.teamList.member,function(t){return a("el-checkbox",{key:t.id,attrs:{label:t}},[e._v(e._s(t.name))])}))],1),e._v(" "),a("el-form-item",{attrs:{label:"考试排名"}},[a("el-radio-group",{model:{value:e.form.isRanking,callback:function(t){e.$set(e.form,"isRanking",t)},expression:"form.isRanking"}},[a("el-radio",{attrs:{label:1}},[e._v("显示")]),e._v(" "),a("el-radio",{attrs:{label:0}},[e._v("不显示")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"考试规则"}},[a("el-checkbox-group",{staticClass:"checkbox",model:{value:e.form.rule,callback:function(t){e.$set(e.form,"rule",t)},expression:"form.rule"}},[a("el-checkbox",{attrs:{label:2}},[e._v("题目乱序, 每个人题目顺序不同.")]),e._v(" "),a("el-checkbox",{attrs:{label:3}},[e._v("不允许从别处复制内容粘贴到题目中做答.")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"通知方式"}},[a("el-radio-group",{model:{value:e.form.notice,callback:function(t){e.$set(e.form,"notice",t)},expression:"form['notice']"}},[a("el-radio",{attrs:{label:1}},[e._v("短信")]),e._v(" "),a("el-radio",{attrs:{label:2}},[e._v("微信")]),e._v(" "),a("el-radio",{attrs:{label:3}},[e._v("短信&微信")])],1)],1),e._v(" "),a("el-form-item",[a("el-button",{staticClass:"bg-green btn",attrs:{type:"success"},on:{click:function(t){e.submitForm("form")}}},[e._v("创建")]),e._v(" "),a("el-button",{staticClass:"btn",attrs:{type:"info"},on:{click:function(t){e.$router.back(-1)}}},[e._v("取消")])],1)],1)],1)],1)},[],!1,null,"bf187d4a",null);m.options.__file="create.vue";t.default=m.exports},qdgl:function(e,t,a){"use strict";var i=a("Knb+");a.n(i).a}}]);