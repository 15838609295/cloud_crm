(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-192b"],{Vn12:function(t,e,a){"use strict";var i=a("ju5t");a.n(i).a},aamz:function(t,e,a){"use strict";a.r(e);var i=a("zAZ/"),r={data:function(){return{downloadLoading:!1,searchTerms:{activity_type:"",state:"",date:[],search:""},typeList:[],tableMaxHeight:document.documentElement.clientHeight-380,tableLoading:!1,multipleSelection:[],currentPage:1,pageSize:this.$store.getters.userInfo.pageSize,pageSizes:[10,20,50,100,1e3],total:0,tableData:[],activityList:[],dialogVisible:!1,form:{activityId:""},rules:{activityId:[{required:!0,message:"请输入姓名",trigger:"change"}]}}},created:function(){this.getData(),this.getTypeList(),this.getActivityList()},methods:{handleCurrentChange:i.c,handleSizeChange:i.d,handleSortChange:i.e,parseTime:i.f,getData:function(t){var e=this;this.tableLoading=!0,t||(t={});var a={page_no:this.currentPage,page_size:this.pageSize,search:this.searchTerms.search,status:this.searchTerms.status,activity_type:this.searchTerms.activity_type};this.searchTerms.date&&0!==this.searchTerms.date.length&&(a.start_time=this.searchTerms.date[0]+" 00:00:00",a.end_time=this.searchTerms.date[1]+" 23:59:59"),t.sortName&&(a.sortName=t.sortName),t.sortOrder&&(a.sortOrder=t.sortOrder),this.$store.dispatch("GetConnect",{url:"activity/getActivityList",data:a}).then(function(t){e.tableData=t.data.rows,e.total=t.data.total,e.tableLoading=!1}).catch(function(t){e.tableLoading=!1,e.$message.error(t.msg+",请刷新或联系管理员")})},getTypeList:function(){var t=this;this.$store.dispatch("GetConnect",{url:"activity/getTypeList"}).then(function(e){t.typeList=e.data}).catch(function(e){t.$message.error(e.msg+",请刷新或联系管理员")})},getActivityList:function(){var t=this;this.$store.dispatch("GetConnect",{url:"activity/activityAllList"}).then(function(e){t.activityList=e.data}).catch(function(e){t.$message.error(e.msg+",请刷新或联系管理员")})},toInfo:function(t){this.$router.push({path:"/activity/details",query:{id:t.id}})},toModify:function(t){this.$router.push({path:"/activity/modify",query:{id:t.id}})},toDelete:function(t){var e=this;this.$confirm("此操作将删除该活动, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a="activity/activityDel/"+t.id;e.$store.dispatch("GetConnect",{url:a}).then(function(t){e.$message.success(t.msg),e.getData(),e.getActivityList()}).catch(function(t){e.$message.error(t.msg+",请刷新或联系管理员")})})},toCreateActivity:function(){this.$router.push({path:"/activity/create"})},submitForm:function(t){var e=this;this.$refs[t].validate(function(t){t?e.$router.push({path:"/activity/modify",query:{fromId:e.form.activityId}}):e.$message.error("提交失败,请检查必填项")})},resetForm:function(t){this.$refs[t].resetFields()}}},s=(a("Vn12"),a("KHd+")),n=Object(s.a)(r,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container bg-gray"},[a("el-card",{staticClass:"box-1"},[a("div",{staticClass:"header"},[a("div",[a("el-select",{staticClass:"select",attrs:{placeholder:"活动类型",clearable:"",filterable:""},on:{change:t.getData},model:{value:t.searchTerms.activity_type,callback:function(e){t.$set(t.searchTerms,"activity_type",e)},expression:"searchTerms['activity_type']"}},t._l(t.typeList,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),t._v(" "),a("el-select",{staticClass:"select",attrs:{placeholder:"活动状态",clearable:""},on:{change:t.getData},model:{value:t.searchTerms.status,callback:function(e){t.$set(t.searchTerms,"status",e)},expression:"searchTerms.status"}},[a("el-option",{attrs:{value:1,label:"报名中"}}),t._v(" "),a("el-option",{attrs:{value:2,label:"报名截止"}}),t._v(" "),a("el-option",{attrs:{value:3,label:"活动进行中"}}),t._v(" "),a("el-option",{attrs:{value:4,label:"活动已结束"}}),t._v(" "),a("el-option",{attrs:{value:0,label:"已取消"}})],1),t._v(" "),a("el-date-picker",{staticClass:"picker",attrs:{editable:!1,type:"daterange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd"},on:{change:t.getData},model:{value:t.searchTerms.date,callback:function(e){t.$set(t.searchTerms,"date",e)},expression:"searchTerms.date"}}),t._v(" "),a("el-input",{staticClass:"search-input",attrs:{placeholder:"请输入活动名称"},on:{change:t.getData},model:{value:t.searchTerms.search,callback:function(e){t.$set(t.searchTerms,"search",e)},expression:"searchTerms.search"}}),t._v(" "),a("el-button",{staticClass:"do-btn",attrs:{type:"success",icon:"el-icon-search"},on:{click:t.getData}},[t._v("搜索")])],1),t._v(" "),a("div",[a("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:t.toCreateActivity}},[t._v("创建活动")]),t._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(e){t.dialogVisible=!0}}},[t._v("从已有活动创建")])],1)]),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading,expression:"tableLoading"}],attrs:{data:t.tableData,"max-height":t.tableMaxHeight,border:"","highlight-current-row":""},on:{"sort-change":t.handleSortChange}},[a("el-table-column",{attrs:{prop:"id",label:"ID",width:"100","header-align":"center",align:"center",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"名称","min-width":"160","header-align":"center",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"host_party",label:"发起人","min-width":"120","header-align":"center",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"total_number",label:"已报名",width:"120","header-align":"center",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:"活动时间","min-width":"200","header-align":"center",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(t.parseTime(e.row.start_time,"{y}-{m}-{d} {h}:{i}")+" 至 "+t.parseTime(e.row.end_time,"{y}-{m}-{d} {h}:{i}"))+"\n        ")]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"buy_time",label:"更新时间","min-width":"160","header-align":"center",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.updated_at?t.parseTime(e.row.updated_at,"{y}-{m}-{d}"):"--")+"\n        ")]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"activity_status",label:"活动状态",width:"160","header-align":"center",align:"center",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[0===e.row.activity_status?a("el-tag",{attrs:{type:"danger"}},[t._v("已取消")]):t._e(),t._v(" "),1===e.row.activity_status?a("el-tag",{attrs:{type:"primary"}},[t._v("报名中")]):t._e(),t._v(" "),2===e.row.activity_status?a("el-tag",{attrs:{type:"warning"}},[t._v("报名截止")]):t._e(),t._v(" "),3===e.row.activity_status?a("el-tag",{attrs:{type:"success"}},[t._v("活动进行中")]):t._e(),t._v(" "),4===e.row.activity_status?a("el-tag",{attrs:{type:"info"}},[t._v("活动已结束")]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"200","header-align":"center",align:"center",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-search",circle:""},on:{click:function(a){t.toInfo(e.row)}}}),t._v(" "),1===e.row.activity_status||2===e.row.activity_status?a("el-button",{staticClass:"bg-green",attrs:{type:"primary",size:"small",icon:"el-icon-edit",circle:""},on:{click:function(a){t.toModify(e.row)}}}):t._e(),t._v(" "),4===e.row.activity_status||0===e.row.activity_status?a("el-button",{attrs:{type:"danger",size:"small",icon:"el-icon-delete",circle:""},on:{click:function(a){t.toDelete(e.row)}}}):t._e()]}}])})],1),t._v(" "),a("el-pagination",{staticClass:"pagination",attrs:{"current-page":t.currentPage,"page-size":t.pageSize,"page-sizes":t.pageSizes,total:t.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"update:currentPage":function(e){t.currentPage=e},"current-change":t.handleCurrentChange,"size-change":t.handleSizeChange}})],1),t._v(" "),a("el-dialog",{staticClass:"dialog",attrs:{visible:t.dialogVisible,title:"选择活动",width:"500px",center:""},on:{"update:visible":function(e){t.dialogVisible=e},close:function(e){t.resetDialog("form")}}},[a("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"活动",prop:"activityId"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择类型"},model:{value:t.form.activityId,callback:function(e){t.$set(t.form,"activityId",e)},expression:"form.activityId"}},t._l(t.activityList,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitForm("form")}}},[t._v("确 定")])],1)],1)],1)},[],!1,null,"caad397c",null);n.options.__file="list.vue";e.default=n.exports},ju5t:function(t,e,a){},"zAZ/":function(t,e,a){"use strict";a.d(e,"e",function(){return s}),a.d(e,"c",function(){return n}),a.d(e,"d",function(){return o}),a.d(e,"a",function(){return c}),a.d(e,"f",function(){return l}),a.d(e,"b",function(){return u});var i=a("EJiy"),r=a.n(i);function s(t){var e=t.column,a=t.prop,i=t.order;this.order={column:e,prop:a,order:i},this.getData({sortName:a,sortOrder:i&&("ascending"===i?"asc":"desc")})}function n(t){this.getData(this.order?{sortName:this.order.prop,sortOrder:this.order.order&&("ascending"===this.order.order?"asc":"desc")}:{})}function o(t){this.$store.getters.userInfo.pageSize=t,this.pageSize=t,this.getData(this.order?{sortName:this.order.prop,sortOrder:this.order.order&&("ascending"===this.order.order?"asc":"desc")}:{})}function c(t){this.th[t].check=!this.th[t].check}function l(t,e){if(0===arguments.length)return null;var a=e||"{y}-{m}-{d} {h}:{i}:{s}",i=void 0;"object"===(void 0===t?"undefined":r()(t))?i=t:(10===(""+t).length&&(t=1e3*parseInt(t)),i=new Date(t));var s={y:i.getFullYear(),m:i.getMonth()+1,d:i.getDate(),h:i.getHours(),i:i.getMinutes(),s:i.getSeconds(),a:i.getDay()};return a.replace(/{(y|m|d|h|i|s|a)+}/g,function(t,e){var a=s[e];return"a"===e?["日","一","二","三","四","五","六"][a]:(t.length>0&&a<10&&(a="0"+a),a||0)})}function u(t){var e=t.substr(0,10);e=e.replace(/-/g,"/");var a=new Date(e),i=new Date;i=i.valueOf();var r=Math.ceil((a-i)/864e5);return 0===r?"今天":r>0&&r<30?r+"天":r>=30&&r<360?Math.ceil(r/30)+"月":r>=360?Math.ceil(r/360)+"年":"逾期"+Math.ceil((i-a)/864e5)+"天"}}}]);