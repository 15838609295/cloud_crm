(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-d831"],{Ashb:function(e,t,o){"use strict";o.r(t);var i=o("gDS+"),s=o.n(i),r=o("P2sY"),l=o.n(r),a={data:function(){return{ImageUrl:"",title:"",dialogVisible:!1,tableIdx:null,versionForm:{goods_version:"",image:"",subitem:[],defaultData:{count:"",originalPrice:"",salePrice:"",costPrice:"",goodsNum:""}},versionFormRules:{goods_version:[{required:!0,message:"请输入规格",trigger:"blur"}],image:[{required:!0,message:"请选择图片",trigger:"blur"}]},dialogVisible2:!1,tableIdx2:null,versionForm2:{goods_version:"",count:"",originalPrice:"",costPrice:"",salePrice:"",goodsNum:""},versionFormRules2:{sub_version:[{required:!0,message:"请输入子规格",trigger:"blur"}],count:[{required:!0,message:"请输入库存",trigger:"blur"}],originalPrice:[{required:!0,message:"请输入原价",trigger:"blur"}],salePrice:[{required:!0,message:"请输入售价",trigger:"blur"}],goodsNum:[{required:!0,message:"请输入货号",trigger:"blur"}]},productTypeList:[],form:{goods_name:"",goods_pic:"",pic_list:"",pic_list_url:[],goods_type:"",goods_version:[],price_type:"",status:"",goods_top:"",body:""},formRules:{goods_name:[{required:!0,message:"请输入名称",trigger:"blur"}],goods_type:[{required:!0,message:"请选择类型",trigger:"blur"}]}}},watch:{},created:function(){this.title=this.$route.query.title,this.getProductTypeList()},methods:{getProductTypeList:function(){var e=this;this.$store.dispatch("GetConnect",{url:"goods/goodsTypeList"}).then(function(t){e.productTypeList=t.data,e.$route.query.id&&(e.id=e.$route.query.id,e.getInfo(e.$route.query.id))}).catch(function(t){e.$message.error(t.msg+",请刷新或联系管理员")})},getInfo:function(e){var t=this,o="goods/detail/"+e;this.$store.dispatch("GetConnect",{url:o}).then(function(e){var o={id:e.data.id,goods_name:e.data.goods_name,goods_pic:e.data.goods_pic,pic_list:e.data.pic_list||"",pic_list_url:[],goods_type:e.data.goods_type,goods_version:e.data.goods_version?JSON.parse(e.data.goods_version):[],price_type:e.data.price_type,status:e.data.status,goods_top:e.data.goods_top,body:e.data.body},i=o.pic_list.split(","),s=[];for(var r in i)s.push({id:i[r],url:t.ImageUrl+i[r]});o.pic_list_url=s;for(var a=0;a<o.goods_version.length;a++)o.goods_version[a].defaultData={count:"",originalPrice:"",salePrice:"",goodsNum:""};console.log(o),l()(t.form,o),t.expandAll()}).catch(function(e){t.$message.error(e.msg+",请刷新或联系管理员")})},showDialog:function(){this.dialogVisible=!0,this.tableIdx=null},toAddPriceDetail:function(){var e=this;this.$refs.versionForm.validate(function(t){t?(console.log(e.form.goods_version),null===e.tableIdx?(e.form.goods_version.push(e.versionForm),e.expandAll()):e.form.goods_version[e.tableIdx]=e.versionForm,e.dialogVisible=!1,e.tableIdx=null):e.$message.error("提交失败,请检查必填项")})},toEditPriceDetail:function(e){this.dialogVisible=!0,this.versionForm=e.row,this.tableIdx=e.$index},toDeletePriceDetail:function(e){var t=this;this.$confirm("是否删除该规格?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.form.goods_version.splice(e,1),t.expandAll()})},setDefaultData:function(e){for(var t=this.form.goods_version[e.$index],o=0;o<t.subitem.length;o++)""!==t.defaultData.count&&(t.subitem[o].count=t.defaultData.count),""!==t.defaultData.originalPrice&&(t.subitem[o].originalPrice=t.defaultData.originalPrice),""!==t.defaultData.costPrice&&(t.subitem[o].costPrice=t.defaultData.costPrice),""!==t.defaultData.salePrice&&(t.subitem[o].salePrice=t.defaultData.salePrice),""!==t.defaultData.goodsNum&&(t.subitem[o].goodsNum=t.defaultData.goodsNum);this.form.goods_version[e.$index].subitem=t.subitem,l()(this.form.goods_version[e.$index].defaultData,{count:"",originalPrice:"",salePrice:"",goodsNum:""})},showDialog2:function(e){console.log(e),this.dialogVisible2=!0,this.tableIdx=e.$index},toAddPriceDetail2:function(){null===this.tableIdx2?this.form.goods_version[this.tableIdx].subitem.push(this.versionForm2):l()(this.form.goods_version[this.tableIdx].subitem[this.tableIdx2],this.versionForm2),this.dialogVisible2=!1,this.tableIdx=null,this.tableIdx2=null},toEditPriceDetail2:function(e,t){console.log(t),this.dialogVisible2=!0,this.versionForm2=t.row,this.tableIdx=e.$index,this.tableIdx2=t.$index},toDeletePriceDetail2:function(e,t){var o=this;this.$confirm("是否删除该子规格?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){o.form.goods_version[e].subitem.splice(t,1)})},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(e){var o=t.form;if(0===o.goods_version.length)return void t.$message.error("请添加产品规格");o.goods_attr=s()(o.goods_version),console.log(o.goods_attr);var i=t.id?"goods/edit/"+t.id:"goods/create";t.$store.dispatch("GetConnect",{url:i,data:o}).then(function(e){t.$message.success(e.msg),t.$router.back(-1)}).catch(function(e){t.$message.error(e.msg)})}else t.$message.error("提交失败,请检查必填项")})},resetForm:function(e){this.$refs[e].resetFields()},expandAll:function(){var e=document.getElementsByClassName("el-table__expand-icon");this.$nextTick(function(){for(var t=0;t<e.length;t++)e[t].click()})}}},n=(o("Mgkn"),o("NSZt"),o("KHd+")),c=Object(n.a)(a,function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("el-card",{staticClass:"box-1"},[o("div",{attrs:{slot:"header"},slot:"header"},[o("span",[e._v(e._s(e.title))])]),e._v(" "),o("el-form",{ref:"form",attrs:{model:e.form,rules:e.formRules,"label-width":"140px"}},[o("el-form-item",{attrs:{label:"名称：",prop:"goods_name"}},[o("el-input",{model:{value:e.form.goods_name,callback:function(t){e.$set(e.form,"goods_name",t)},expression:"form.goods_name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"略缩图："}},[o("ws-upload-single-img",{attrs:{path:e.form.goods_pic?e.ImageUrl+e.form.goods_pic:""},model:{value:e.form.goods_pic,callback:function(t){e.$set(e.form,"goods_pic",t)},expression:"form['goods_pic']"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"图片列表",prop:"title"}},[o("div",{staticClass:"remark"},[e._v("*注:最多传三张图")]),e._v(" "),o("ws-upload-multiple-img",{attrs:{path:e.form.pic_list_url,limit:3},model:{value:e.form.pic_list,callback:function(t){e.$set(e.form,"pic_list",t)},expression:"form['pic_list']"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"类型：",prop:"goods_type"}},[o("el-select",{attrs:{placeholder:"请选择所属类型"},model:{value:e.form.goods_type,callback:function(t){e.$set(e.form,"goods_type",t)},expression:"form.goods_type"}},e._l(e.productTypeList,function(e){return o("el-option",{key:e.id,attrs:{value:e.id,label:e.name}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"产品规格："}},[o("el-button",{staticClass:"bg-green",attrs:{type:"success"},on:{click:e.showDialog}},[e._v("新增规格")]),e._v(" "),o("el-table",{staticStyle:{border:"1px solid #ddd"},attrs:{data:e.form.goods_version,"row-class-name":"bg-gray"}},[o("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{size:"small",type:"info"},on:{click:function(o){e.showDialog2(t)}}},[e._v("新增子规格")]),e._v(" "),o("el-input",{staticStyle:{width:"90px"},attrs:{size:"small",placeholder:"库存"},model:{value:t.row.defaultData.count,callback:function(o){e.$set(t.row.defaultData,"count",o)},expression:"props.row.defaultData['count']"}}),e._v(" "),o("el-input",{staticStyle:{width:"90px"},attrs:{size:"small",placeholder:"原价"},model:{value:t.row.defaultData.originalPrice,callback:function(o){e.$set(t.row.defaultData,"originalPrice",o)},expression:"props.row.defaultData['originalPrice']"}}),e._v(" "),o("el-input",{staticStyle:{width:"90px"},attrs:{size:"small",placeholder:"成本"},model:{value:t.row.defaultData.costPrice,callback:function(o){e.$set(t.row.defaultData,"costPrice",o)},expression:"props.row.defaultData['costPrice']"}}),e._v(" "),o("el-input",{staticStyle:{width:"90px"},attrs:{size:"small",placeholder:"售价"},model:{value:t.row.defaultData.salePrice,callback:function(o){e.$set(t.row.defaultData,"salePrice",o)},expression:"props.row.defaultData['salePrice']"}}),e._v(" "),o("el-input",{staticStyle:{width:"90px"},attrs:{size:"small",placeholder:"货号"},model:{value:t.row.defaultData.goodsNum,callback:function(o){e.$set(t.row.defaultData,"goodsNum",o)},expression:"props.row.defaultData['goodsNum']"}}),e._v(" "),o("el-button",{attrs:{size:"small"},on:{click:function(o){e.setDefaultData(t)}}},[e._v("设置")]),e._v(" "),o("el-table",{attrs:{data:t.row.subitem}},[o("el-table-column",{attrs:{label:"子规格","min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-tag",{attrs:{type:"info"}},[e._v(e._s(t.row.goods_version))])]}}])}),e._v(" "),o("el-table-column",{attrs:{label:"库存",prop:"count","min-width":"60"}}),e._v(" "),o("el-table-column",{attrs:{label:"原价",prop:"originalPrice","min-width":"60"}}),e._v(" "),o("el-table-column",{attrs:{label:"成本",prop:"costPrice","min-width":"60"}}),e._v(" "),o("el-table-column",{attrs:{label:"售价",prop:"salePrice","min-width":"60"}}),e._v(" "),o("el-table-column",{attrs:{label:"货号",prop:"goodsNum","min-width":"60"}}),e._v(" "),o("el-table-column",{attrs:{label:"管理",width:"160","header-align":"center",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(i){return[o("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-edit"},on:{click:function(o){e.toEditPriceDetail2(t,i)}}},[e._v("编辑")]),e._v(" "),o("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-delete",circle:""},on:{click:function(o){e.toDeletePriceDetail2(t.$index,i.$index)}}},[e._v("删除")])]}}])})],1)]}}])}),e._v(" "),o("el-table-column",{attrs:{label:"规格名称","min-width":"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-tag",[e._v(e._s(t.row.goods_version))])]}}])}),e._v(" "),o("el-table-column",{attrs:{label:"图片","header-align":"center",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("ws-show-img",{staticStyle:{width:"60px",height:"60px"},attrs:{src:e.ImageUrl+t.row.image}})]}}])}),e._v(" "),o("el-table-column",{attrs:{label:"管理","min-width":"160","header-align":"center",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{staticClass:"bg-green",attrs:{type:"success",size:"small",icon:"el-icon-edit",circle:""},on:{click:function(o){e.toEditPriceDetail(t)}}}),e._v(" "),o("el-button",{attrs:{type:"danger",size:"small",icon:"el-icon-delete",circle:""},on:{click:function(o){e.toDeletePriceDetail(t.$index)}}})]}}])})],1)],1),e._v(" "),o("el-form-item",{attrs:{label:"代理商价格"}},[o("el-radio-group",{model:{value:e.form.price_type,callback:function(t){e.$set(e.form,"price_type",t)},expression:"form.price_type"}},[o("el-radio",{attrs:{label:0}},[e._v("默认")]),e._v(" "),o("el-radio",{attrs:{label:1}},[e._v("一口价")])],1)],1),e._v(" "),o("el-form-item",{attrs:{label:"状态"}},[o("el-radio-group",{model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},[o("el-radio",{attrs:{label:0}},[e._v("上架")]),e._v(" "),o("el-radio",{attrs:{label:1}},[e._v("下架")])],1)],1),e._v(" "),o("el-form-item",{attrs:{label:"置顶权重"}},[o("el-input",{attrs:{placeholder:"请输入置顶权重,为整数型"},model:{value:e.form.goods_top,callback:function(t){e.$set(e.form,"goods_top",t)},expression:"form.goods_top"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"详情介绍"}},[o("ws-editor",{model:{value:e.form.body,callback:function(t){e.$set(e.form,"body",t)},expression:"form['body']"}})],1),e._v(" "),o("div",{staticStyle:{"text-align":"center"}},[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("form")}}},[e._v(e._s("编辑产品"===e.title?"保存":"立即创建"))]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.$router.back(-1)}}},[e._v("取消")])],1)],1)],1),e._v(" "),o("el-dialog",{staticClass:"dialog",staticStyle:{"background-color":"rgba(60, 60, 60, 0.8)"},attrs:{visible:e.dialogVisible,modal:!1,title:"价格明细",width:"420px"},on:{"update:visible":function(t){e.dialogVisible=t},close:function(t){e.versionForm={subitem:[]}}}},[o("el-form",{ref:"versionForm",attrs:{model:e.versionForm,rules:e.versionFormRules,"label-width":"80px"}},[o("el-form-item",{attrs:{label:"规格",prop:"goods_version"}},[o("el-input",{model:{value:e.versionForm.goods_version,callback:function(t){e.$set(e.versionForm,"goods_version",t)},expression:"versionForm.goods_version"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"图片"}},[o("ws-upload-single-img",{attrs:{path:e.versionForm.image?e.ImageUrl+e.versionForm.image:""},model:{value:e.versionForm.image,callback:function(t){e.$set(e.versionForm,"image",t)},expression:"versionForm['image']"}})],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.toAddPriceDetail()}}},[e._v("确 定")])],1)],1),e._v(" "),o("el-dialog",{staticClass:"dialog",attrs:{visible:e.dialogVisible2,title:"子规格",width:"420px",center:""},on:{"update:visible":function(t){e.dialogVisible2=t},close:function(t){e.versionForm2={}}}},[o("el-form",{ref:"versionForm2",attrs:{model:e.versionForm2,rules:e.versionFormRules2,"label-width":"80px"}},[o("el-form-item",{attrs:{label:"规格",prop:"goods_version"}},[o("el-input",{model:{value:e.versionForm2.goods_version,callback:function(t){e.$set(e.versionForm2,"goods_version",t)},expression:"versionForm2.goods_version"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"库存",prop:"count"}},[o("el-input",{model:{value:e.versionForm2.count,callback:function(t){e.$set(e.versionForm2,"count",t)},expression:"versionForm2.count"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"售价",prop:"salePrice"}},[o("el-input",{model:{value:e.versionForm2.salePrice,callback:function(t){e.$set(e.versionForm2,"salePrice",t)},expression:"versionForm2.salePrice"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"成本价",prop:"costPrice"}},[o("el-input",{model:{value:e.versionForm2.costPrice,callback:function(t){e.$set(e.versionForm2,"costPrice",t)},expression:"versionForm2.costPrice"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"原价",prop:"originalPrice"}},[o("el-input",{model:{value:e.versionForm2.originalPrice,callback:function(t){e.$set(e.versionForm2,"originalPrice",t)},expression:"versionForm2.originalPrice"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"货号",prop:"goodsNum"}},[o("el-input",{model:{value:e.versionForm2.goodsNum,callback:function(t){e.$set(e.versionForm2,"goodsNum",t)},expression:"versionForm2.goodsNum"}})],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.dialogVisible2=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.toAddPriceDetail2()}}},[e._v("确 定")])],1)],1)],1)},[],!1,null,"733176c8",null);c.options.__file="modify.vue";t.default=c.exports},Mgkn:function(e,t,o){"use strict";var i=o("yqJc");o.n(i).a},NSZt:function(e,t,o){"use strict";var i=o("sjYG");o.n(i).a},sjYG:function(e,t,o){},yqJc:function(e,t,o){}}]);