(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-4702"],{"/4ME":function(s,e,t){},"UtC/":function(s,e,t){"use strict";var i=t("/4ME");t.n(i).a},tCZc:function(s,e,t){"use strict";t.r(e);var i=t("14Xm"),r=t.n(i),o=t("D3Ub"),n=t.n(o),a=["achievement","admin_bonus_log","admin_permission_role","admin_permissions","admin_role_user","admin_roles","admin_session","admin_users","admin_users_extend","after_sale","articles","assign_log","branchs","cases","communicationlog","company","configs","customer","goods","member","member_extend","member_level","member_session","member_source","migrations","orders","password_resets","problem","project","salebonusrule","sys_version","take_bonus","user_branch","users","wallet_logs","work_order","work_order_log","work_order_type","verification","tencent_order","tencent_order_price","picture","bonus_sale","goods_type","activity","activity_type","album","articles_type","attend","banner","china","collect","comment","fabulous","form_id","home_page","industry_type","member_vip","proposal","permissions","customer_log","findings","questionnaire","subject","test_paper","item_bank","street","operate_log","member_contact_log","member_assign_log","examinee_group_role","examinee_group","exam_type","exam_results","exam","achievement_extend","modular"],l={name:"ApplicationInstanceSystem",data:function(){return{loading:!1,sqlIdx:0,progress:0,dbTableList:a,progressMsgList:[],isInstallFinish:!1,isInstallFail:!1,systemUrl:""}},mounted:function(){},methods:{publish:function(){var s=this;this.loading=!0,this.progressMsgList=[],this.listenerProgress("========== 开始安装"),n()(r.a.mark(function e(){var t;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.$service.adminSystemInstallDatabase();case 2:0===(t=e.sent).code?(s.isInstallFinish=!0,s.systemUrl=t.data.url,console.log("========== 安装成功 | 系统路径: "+s.systemUrl),90===s.progress&&(console.log("========== 安装成功 | "+s.progress),s.progress=100,s.addPublishMsg("========== 安装成功 | 系统路径: "+s.systemUrl))):(s.isInstallFail=!0,s.addPublishMsg("========== 安装失败 | "+t.msg),s.$message.error(t.msg));case 4:case"end":return e.stop()}},e,s)}))()},listenerProgress:function(s){var e=this;this.progress=(parseFloat(this.progress)+parseFloat(90/this.dbTableList.length)).toFixed(2),console.log(this.progress),this.progress>90&&(this.progress=90),console.log(this.progress),s&&!this.isInstallFail&&this.addPublishMsg(s),90===this.progress||this.isInstallFail?90===this.progress&&this.isInstallFinish&&(console.log("========== 安装成功 | 系统路径: "+this.systemUrl),this.progress=100,this.addPublishMsg("========== 安装成功 | 系统路径: "+this.systemUrl)):(this.sqlIdx++,setTimeout(function(){return e.listenerProgress("安装进度: "+e.progress+"% | 初始化表 "+e.dbTableList[e.sqlIdx])},50))},addPublishMsg:function(s){var e=this;this.progressMsgList.push(s),setTimeout(function(){e.$refs.items.scrollIntoView(!1)},50)},goSystem:function(){window.location.href=this.systemUrl}}},c=(t("UtC/"),t("KHd+")),p=Object(c.a)(l,function(){var s=this,e=s.$createElement,t=s._self._c||e;return t("div",{staticClass:"app-container"},[t("el-steps",{staticClass:"step",attrs:{active:3,simple:""}},[t("el-step",{attrs:{title:"安装环境检测",icon:"el-icon-s-platform"}}),s._v(" "),t("el-step",{attrs:{title:"系统信息录入",icon:"el-icon-edit"}}),s._v(" "),t("el-step",{attrs:{title:"执行初始化",icon:"el-icon-upload"}}),s._v(" "),t("el-step",{attrs:{title:"开始使用",icon:"el-icon-success"}})],1),s._v(" "),t("div",{staticClass:"app-container"},[t("el-card",{staticClass:"content-edit"},[t("div",{staticClass:"header",attrs:{slot:"header"},slot:"header"},[t("span",[s._v("安装应用")])]),s._v(" "),t("el-form",{attrs:{"label-width":"120px"}},[t("div",{staticClass:"content"},[t("div",{ref:"items",staticClass:"items"},s._l(s.progressMsgList,function(e){return t("div",{key:e.id},[t("span",{staticClass:"item"},[s._v(s._s(e))])])}))])]),s._v(" "),t("div",{staticClass:"footer"},[!s.loading&&s.isInstallFail?t("el-button",{on:{click:function(e){s.$router.go(-1)}}},[s._v("上 一 步")]):s._e(),s._v(" "),s.loading?s._e():t("el-button",{attrs:{type:"primary"},on:{click:s.publish}},[s._v("开始安装")]),s._v(" "),s.isInstallFail?t("el-button",{attrs:{type:"primary"},on:{click:s.publish}},[s._v("重新安装")]):s._e(),s._v(" "),s.isInstallFinish&&100===s.progress?t("el-button",{attrs:{type:"primary"},on:{click:s.goSystem}},[s._v("开始使用")]):s._e()],1)],1)],1)],1)},[],!1,null,"529f9552",null);p.options.__file="initialize.vue";e.default=p.exports}}]);